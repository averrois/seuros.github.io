---
import Layout from "../layouts/Layout.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title={SITE_TITLE} description={SITE_DESCRIPTION} maxWidth="max-w-7xl">
  <section>
    <ul class="flex flex-wrap gap-8 list-none m-0 p-0 w-full mx-auto">
      {
        posts.map((post, idx) => (
          <li
            class={
              idx === 0
                ? "w-full mb-4 text-center"
                : "w-full sm:w-[calc(50%-1rem)]"
            }
          >
            <a href={`/blog/${post.slug}/`} class="block hover:no-underline">
              {post.data.image?.url && (
                <img
                  width={720}
                  height={360}
                  src={post.data.image.url}
                  alt={post.data.image.alt}
                  class={idx === 0 ? "w-full" : ""}
                />
              )}
              <h4
                class={
                  "title font-bold text-gray-900" +
                  (idx === 0 ? " text-4xl" : "")
                }
              >
                {post.data.title}
              </h4>
              <p class="date text-sm text-gray-500 font-medium">
                <FormattedDate date={post.data.pubDate} />
              </p>
              <p class="text-base text-gray-700">{post.data.description}</p>
            </a>
          </li>
        ))
      }
    </ul>
  </section>
</Layout>
